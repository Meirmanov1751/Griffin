from django.db import models

from osint.models import Osint


class Pentest(models.Model):
    osint = models.ForeignKey(Osint ,on_delete=models.CASCADE, null=True, blank=True, related_name="pentest")
    document = models.FileField(upload_to='documents/', null=True, blank=True)
    organizationName = models.CharField(max_length=200, null=True, blank=True)
    personName = models.CharField(max_length=200, null=True, blank=True)
    goalsAndTasks = models.TextField(null=True, blank=True)
    dataCollection = models.TextField(null=True, blank=True)
    dataFilteringAndAnalysis = models.TextField(null=True, blank=True)
    dataStorage = models.TextField(null=True, blank=True)
    url = models.URLField(null=True, blank=True)
    clickjacking = models.TextField(null=True, blank=True)
    csrf = models.TextField(null=True, blank=True)
    info = models.TextField(null=True, blank=True)
    open_ports = models.TextField(null=True, blank=True)
    sql_injection = models.TextField(null=True, blank=True)
    xss = models.TextField(null=True, blank=True)

    def __str__(self):
        return f'{self.organizationName} | {self.url} | {self.personName} | {self.goalsAndTasks}'

    class Meta:
        verbose_name = 'Pentest'
        verbose_name_plural = 'Pentests'
        ordering = ['organizationName']
