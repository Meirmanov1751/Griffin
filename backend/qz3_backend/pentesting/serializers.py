from rest_framework import serializers

from OWASP.serializers import SecurityLoggingSerializer, KnownVulnerabilitiesSerializer, \
    InsecureDeserializationAttackSerializer, XSSAttackSerializer, SecurityMisconfigurationSerializer, \
    AccessControlViolationSerializer, XXEViolationSerializer, SensitiveDataExposureSerializer, \
    AuthenticationViolationSerializer, InjectionSerializer
from PCOPT.serializers import PCOPTSerializer
from PTES.serializers import AuditInitiationSerializer, InformationGatheringSerializer, VulnerabilityAnalysisSerializer, \
    AccessMaintenanceSerializer, DataAnalysisAndDocumentationSerializer, AuditCompletionSerializer, \
    AuditPreparationAndPlanningSerializer, AuditExecutionAndTestingSerializer, ResultsAnalysisAndReportingSerializer
from .models import Pentest


class PentestSerializer(serializers.ModelSerializer):
    PCOPT = PCOPTSerializer(read_only=True)

    PTES_AuditInitiation = AuditInitiationSerializer(read_only=True)
    PTES_InformationGathering = InformationGatheringSerializer(read_only=True)
    PTES_VulnerabilityAnalysis = VulnerabilityAnalysisSerializer(read_only=True)
    PTES_AccessMaintenance = AccessMaintenanceSerializer(read_only=True)
    PTES_DataAnalysisAndDocumentation = DataAnalysisAndDocumentationSerializer(read_only=True)
    PTES_AuditCompletion = AuditCompletionSerializer(read_only=True)
    PTES_AuditPreparationAndPlanning = AuditPreparationAndPlanningSerializer(read_only=True)
    PTES_AuditExecutionAndTesting = AuditExecutionAndTestingSerializer(read_only=True)
    PTES_ResultsAnalysisAndReporting = ResultsAnalysisAndReportingSerializer(read_only=True)

    OWASP_injection = InjectionSerializer(read_only=True)
    OWASP_AuthenticationViolation = AuthenticationViolationSerializer(read_only=True)
    OWASP_SensitiveDataExposure = SensitiveDataExposureSerializer(read_only=True)
    OWASP_XXEViolation = XXEViolationSerializer(read_only=True)
    OWASP_AccessControlViolation = AccessControlViolationSerializer(read_only=True)
    OWASP_SecurityMisconfiguration = SecurityMisconfigurationSerializer(read_only=True)
    OWASP_XSSAttack = XSSAttackSerializer(read_only=True)
    OWASP_InsecureDeserializationAttack = InsecureDeserializationAttackSerializer(read_only=True)
    OWASP_KnownVulnerabilities = KnownVulnerabilitiesSerializer(read_only=True)
    OWASP_SecurityLogging = SecurityLoggingSerializer(read_only=True)

    class Meta:
        model = Pentest
        fields = [
            'id',
            'project',
            'osint',
            'document',
            'organizationName',
            'personName',
            'goalsAndTasks',
            'dataCollection',
            'dataFilteringAndAnalysis',
            'dataStorage',
            'created_at',
            'updated_at',
            'url',
            'PCOPT',
            'PTES_AuditInitiation',
            'PTES_InformationGathering',
            'PTES_VulnerabilityAnalysis',
            'PTES_AccessMaintenance',
            'PTES_DataAnalysisAndDocumentation',
            'PTES_AuditCompletion',
            'PTES_AuditPreparationAndPlanning',
            'PTES_AuditExecutionAndTesting',
            'PTES_ResultsAnalysisAndReporting',
            'OWASP_injection',
            'OWASP_AuthenticationViolation',
            'OWASP_SensitiveDataExposure',
            'OWASP_XXEViolation',
            'OWASP_AccessControlViolation',
            'OWASP_SecurityMisconfiguration',
            'OWASP_XSSAttack',
            'OWASP_InsecureDeserializationAttack',
            'OWASP_KnownVulnerabilities',
            'OWASP_SecurityLogging',
        ]


class PentestListSerializer(serializers.ModelSerializer):
    PCOPT = PCOPTSerializer(read_only=True)

    PTES_AuditInitiation = AuditInitiationSerializer(read_only=True)
    PTES_InformationGathering = InformationGatheringSerializer(read_only=True)
    PTES_VulnerabilityAnalysis = VulnerabilityAnalysisSerializer(read_only=True)
    PTES_AccessMaintenance = AccessMaintenanceSerializer(read_only=True)
    PTES_DataAnalysisAndDocumentation = DataAnalysisAndDocumentationSerializer(read_only=True)
    PTES_AuditCompletion = AuditCompletionSerializer(read_only=True)
    PTES_AuditPreparationAndPlanning = AuditPreparationAndPlanningSerializer(read_only=True)
    PTES_AuditExecutionAndTesting = AuditExecutionAndTestingSerializer(read_only=True)
    PTES_ResultsAnalysisAndReporting = ResultsAnalysisAndReportingSerializer(read_only=True)

    OWASP_injection = InjectionSerializer(read_only=True)
    OWASP_AuthenticationViolation = AuthenticationViolationSerializer(read_only=True)
    OWASP_SensitiveDataExposure = SensitiveDataExposureSerializer(read_only=True)
    OWASP_XXEViolation = XXEViolationSerializer(read_only=True)
    OWASP_AccessControlViolation = AccessControlViolationSerializer(read_only=True)
    OWASP_SecurityMisconfiguration = SecurityMisconfigurationSerializer(read_only=True)
    OWASP_XSSAttack = XSSAttackSerializer(read_only=True)
    OWASP_InsecureDeserializationAttack = InsecureDeserializationAttackSerializer(read_only=True)
    OWASP_KnownVulnerabilities = KnownVulnerabilitiesSerializer(read_only=True)
    OWASP_SecurityLogging = SecurityLoggingSerializer(read_only=True)

    class Meta:
        model = Pentest
        fields = [
            'id',
            'project',
            'osint',
            'document',
            'organizationName',
            'personName',
            'goalsAndTasks',
            'dataCollection',
            'dataFilteringAndAnalysis',
            'dataStorage',
            'url',
            'created_at',
            'updated_at',
            'PCOPT',
            'PTES_AuditInitiation',
            'PTES_InformationGathering',
            'PTES_VulnerabilityAnalysis',
            'PTES_AccessMaintenance',
            'PTES_DataAnalysisAndDocumentation',
            'PTES_AuditCompletion',
            'PTES_AuditPreparationAndPlanning',
            'PTES_AuditExecutionAndTesting',
            'PTES_ResultsAnalysisAndReporting',
            'OWASP_injection',
            'OWASP_AuthenticationViolation',
            'OWASP_SensitiveDataExposure',
            'OWASP_XXEViolation',
            'OWASP_AccessControlViolation',
            'OWASP_SecurityMisconfiguration',
            'OWASP_XSSAttack',
            'OWASP_InsecureDeserializationAttack',
            'OWASP_KnownVulnerabilities',
            'OWASP_SecurityLogging',
        ]

