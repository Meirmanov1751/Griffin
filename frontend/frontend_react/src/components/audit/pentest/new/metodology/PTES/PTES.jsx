import React from 'react';
import {useRef, useState} from "react";
import instance from "../../../../../../store/api";

const PTES = () => {
    const [formData, setFormData] = useState({
        organizationName: '',
        personName: '',
        goalsAndTasks: '',
        dataCollection: '',
        dataFilteringAndAnalysis: '',
        dataStorage: '',
        url: '',
    });
    const inputs = useRef(null);

    const handleChange = (e) => {
        const {name, value} = e.target;
        setFormData({
            ...formData,
            [name]: value,
        });
    };

    const [data, setData] = useState("")

    const handleSubmit = async (e) => {
        e.preventDefault();
        try {
            const response = await instance.post('http://127.0.0.1:8000/api/pentesting/pentesting/', Object.assign({}, formData, data));
            // Обработка успешного ответа от сервера
            debugger
            console.log(response.data);
        } catch (error) {
            // Обработка ошибок при отправке запроса
            console.error(error);
        }
        console.log(formData)
        console.log(data)
    };

    return (
        <div>
            <h1 className={"title-h1"}>PTES</h1>

            <details className={"details-main"} open>
                <summary className={"summary-main"}>
                    Скрыть
                </summary>
                <div>
                    <h2 className={"title-h2"}>1. Инициализация и согласование:</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Определение четких целей и ожиданий аудита:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sqlInjection"
                            ref={inputs}
                            value={formData.sqlInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Согласование методологии и инструментов, используемых во время аудита.:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="crossSiteScripting"
                            ref={inputs}
                            value={formData.crossSiteScripting}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Установление расписания и сроков проведения аудита:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="xmlInjection"
                            ref={inputs}
                            value={formData.xmlInjection}
                            onChange={handleChange}
                        />

                    </details>
                </div>

                <div>
                    <h2 className={"title-h2"}>2. Сбор информации и разведка:</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Поиск и сканирование активов, включая сетевые узлы и веб-ресурсы:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientAuthentication"
                            ref={inputs}
                            value={formData.insufficientAuthentication}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Анализ открытых портов и служб на целевых системах:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sessionManagement"
                            ref={inputs}
                            value={formData.sessionManagement}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}> Исследование документации, доступной публично, связанной с организацией:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sessionTimeout"
                            ref={inputs}
                            value={formData.sessionTimeout}
                            onChange={handleChange}
                        />


                    </details>
                </div>

                <div>
                    <h2 className={"title-h2"}>3. Анализ уязвимостей и эксплуатация</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Поиск уязвимостей в приложениях и системах:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientDataEncryption"
                            ref={inputs}
                            value={formData.insufficientDataEncryption}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}> Попытка эксплуатации уязвимостей для получения доступа:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="weakEncryptionAlgorithms"
                            ref={inputs}
                            value={formData.weakEncryptionAlgorithms}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка реакции системы на атаки и проверка на возможность расширения доступа:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insecurePasswordStorage"
                            ref={inputs}
                            value={formData.insecurePasswordStorage}
                            onChange={handleChange}
                        />


                    </details>
                </div>

                <div>
                    <h2 className={"title-h2"}>4. Поддержание доступа и персистентность</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Установка механизмов для поддержания доступа к системе после успешной эксплуатации:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="xmlExternalEntities"
                            ref={inputs}
                            value={formData.xmlExternalEntities}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Маскировка деятельности атакующего для избегания обнаружения:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="incorrectDataFiltering"
                            ref={inputs}
                            value={formData.incorrectDataFiltering}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Мониторинг активности и доступа к целевым ресурсам:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="remoteFileSystemAccess"
                            ref={inputs}
                            value={formData.remoteFileSystemAccess}
                            onChange={handleChange}
                        />


                    </details>
                </div>

                <div>
                    <h2 className={"title-h2"}>5. Анализ данных и документация</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Запись всех шагов аудита, включая найденные уязвимости и эксплуатацию:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientRoleAndPermissionSeparation"
                            ref={inputs}
                            value={formData.insufficientRoleAndPermissionSeparation}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Создание документации с описанием обнаруженных проблем и рекомендаций по устранению:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientDataAccessControl"
                            ref={inputs}
                            value={formData.insufficientDataAccessControl}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}> Формирование отчета о проведенном аудите с подробным анализом результатов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfProtectionAgainstPrivilegeEscalation"
                            ref={inputs}
                            value={formData.lackOfProtectionAgainstPrivilegeEscalation}
                            onChange={handleChange}
                        />
                    </details>
                </div>

                <div>
                    <h2 className={"title-h2"}>6. Завершение и передача результатов</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Проведение встречи с клиентом для обсуждения найденных уязвимостей и рекомендаций:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="openPortsAndServices"
                            ref={inputs}
                            value={formData.openPortsAndServices}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Передача отчета о проведенном аудите и всех собранных данных клиенту:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="defaultPasswordsAndAccounts"
                            ref={inputs}
                            value={formData.defaultPasswordsAndAccounts}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Завершение проекта и закрытие аудита:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientDirectoryAndFileProtection"
                            ref={inputs}
                            value={formData.insufficientDirectoryAndFileProtection}
                            onChange={handleChange}
                        />

                    </details>
                </div>

                <div>
                    <h2 className={"title-h2"}>7. Подготовка и планирование аудита</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Определение целей и объема аудита на основе потребностей клиента:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="reflectedXss"
                            ref={inputs}
                            value={formData.reflectedXss}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Разработка детального плана аудита, включая выбор методологии и инструментов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="storedXss"
                            ref={inputs}
                            value={formData.storedXss}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Назначение команды аудита и определение их ролей и обязанностей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="domBasedXss"
                            ref={inputs}
                            value={formData.domBasedXss}
                            onChange={handleChange}
                        />

                    </details>
                </div>

                <div>
                    <h2 className={"title-h2"}>8. Выполнение аудита и тестирование</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Проведение активных тестов на проникновение, включая сканирование уязвимостей и эксплуатацию:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insecureDeserialization"
                            ref={inputs}
                            value={formData.insecureDeserialization}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Сбор и анализ данных, связанных с обнаружением и анализом уязвимостей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="executionOfMaliciousCode"
                            ref={inputs}
                            value={formData.executionOfMaliciousCode}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Тестирование политик безопасности, аутентификации и авторизации:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="dataModification"
                            ref={inputs}
                            value={formData.dataModification}
                            onChange={handleChange}
                        />


                    </details>
                </div>

                <div>
                    <h2 className={"title-h2"}>9. Анализ результатов и формирование отчета</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Обработка данных, полученных в результате тестирования и анализа уязвимостей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="useOfOutdatedComponents"
                            ref={inputs}
                            value={formData.useOfOutdatedComponents}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка уровня риска и потенциальных угроз для клиента:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfUpdateMonitoring"
                            ref={inputs}
                            value={formData.lackOfUpdateMonitoring}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Формирование подробного отчета о результатах аудита с рекомендациями по устранению уязвимостей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="useOfComponentsWithKnownVulnerabilities"
                            ref={inputs}
                            value={formData.useOfComponentsWithKnownVulnerabilities}
                            onChange={handleChange}
                        />


                    </details>
                </div>

            </details>

        </div>
    );
};

export default PTES;