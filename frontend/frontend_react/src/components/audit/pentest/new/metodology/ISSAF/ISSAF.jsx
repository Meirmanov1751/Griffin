import React from 'react';
import {useRef, useState} from "react";
import instance from "../../../../../../store/api";

const ISSAF = (pentest) => {
    const [formData, setFormData] = useState({
        organizationName: '',
        personName: '',
        goalsAndTasks: '',
        dataCollection: '',
        dataFilteringAndAnalysis: '',
        dataStorage: '',
        url: '',
    });
    const inputs = useRef(null);

    const handleChange = (e) => {
        const {name, value} = e.target;
        setFormData({
            ...formData,
            [name]: value,
        });
    };

    const [data, setData] = useState("")

    const handleSubmit = async (e) => {
        e.preventDefault();
        try {
            const response = await instance.post('http://127.0.0.1:8000/api/pentesting/pentesting/', Object.assign({}, formData, data));
            // Обработка успешного ответа от сервера
            debugger
            console.log(response.data);
        } catch (error) {
            // Обработка ошибок при отправке запроса
            console.error(error);
        }
        console.log(formData)
        console.log(data)
    };

    return (
        <section id="section2.3">
            <h1 className={"title-h1"}>ISSAF</h1>
            <details className={"details-main"} open>
                <summary className={"summary-main"}>
                    Скрыть
                </summary>
                <section id="section2.3.1">
                    <h2 className={"title-h2"}>1. Идентификация активов :</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Составление инвентаря активов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sqlInjection"
                            ref={inputs}
                            value={formData.sqlInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Классификация активов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="crossSiteScripting"
                            ref={inputs}
                            value={formData.crossSiteScripting}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка стоимости активов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="xmlInjection"
                            ref={inputs}
                            value={formData.xmlInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка уровня защиты:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="commandInjection"
                            ref={inputs}
                            value={formData.commandInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Идентификация уязвимостей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="ldapInjection"
                            ref={inputs}
                            value={formData.ldapInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Документирование и классификация данных:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="noSqlInjection"
                            ref={inputs}
                            value={formData.noSqlInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Определение важных процессов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="serverSideTemplateInjection"
                            ref={inputs}
                            value={formData.serverSideTemplateInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Создание карты активов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="serverSideTemplateInjection"
                            ref={inputs}
                            value={formData.serverSideTemplateInjection}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.3.2">
                    <h2 className={"title-h2"}>2. Оценка уязвимостей :</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Сканирование активов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientAuthentication"
                            ref={inputs}
                            value={formData.insufficientAuthentication}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Использование сканеров уязвимостей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sessionManagement"
                            ref={inputs}
                            value={formData.sessionManagement}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Анализ результатов сканирования:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sessionTimeout"
                            ref={inputs}
                            value={formData.sessionTimeout}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Приоритизация уязвимостей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sessionInformationLeak"
                            ref={inputs}
                            value={formData.sessionInformationLeak}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Разработка плана мероприятий:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="weakPasswords"
                            ref={inputs}
                            value={formData.weakPasswords}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Проведение проверки уязвимостей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="weakPasswords"
                            ref={inputs}
                            value={formData.weakPasswords}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Мониторинг уязвимостей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="weakPasswords"
                            ref={inputs}
                            value={formData.weakPasswords}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Обучение сотрудников:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="weakPasswords"
                            ref={inputs}
                            value={formData.weakPasswords}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.3.3">
                    <h2 className={"title-h2"}>3. Оценка угро</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Идентификация угроз:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientDataEncryption"
                            ref={inputs}
                            value={formData.insufficientDataEncryption}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Слабые алгоритмы шифрования:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="weakEncryptionAlgorithms"
                            ref={inputs}
                            value={formData.weakEncryptionAlgorithms}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка потенциальных ущербов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insecurePasswordStorage"
                            ref={inputs}
                            value={formData.insecurePasswordStorage}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка вероятности:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfAuthenticationForSensitiveDataAccess"
                            ref={inputs}
                            value={formData.lackOfAuthenticationForSensitiveDataAccess}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Ранжирование угроз:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfApiAccessControlAndAuthentication"
                            ref={inputs}
                            value={formData.lackOfApiAccessControlAndAuthentication}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Разработка мер по смягчению рисков:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfApiAccessControlAndAuthentication"
                            ref={inputs}
                            value={formData.lackOfApiAccessControlAndAuthentication}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Создание плана реагирования на инциденты:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfApiAccessControlAndAuthentication"
                            ref={inputs}
                            value={formData.lackOfApiAccessControlAndAuthentication}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.3.4">
                    <h2 className={"title-h2"}>4. Оценка политик и процедур безопасности</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Идентификация существующих политик и процедур:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="xmlExternalEntities"
                            ref={inputs}
                            value={formData.xmlExternalEntities}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Анализ соответствия стандартам безопасности:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="incorrectDataFiltering"
                            ref={inputs}
                            value={formData.incorrectDataFiltering}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка эффективности:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="remoteFileSystemAccess"
                            ref={inputs}
                            value={formData.remoteFileSystemAccess}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка актуальности:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sendingRequestsToExternalResources"
                            ref={inputs}
                            value={formData.sendingRequestsToExternalResources}
                            onChange={handleChange}
                        />


                    </details>
                </section>

                <section id="section2.3.5">
                    <h2 className={"title-h2"}>5. Аутентификация и авторизация</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Идентификация методов аутентификации:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientRoleAndPermissionSeparation"
                            ref={inputs}
                            value={formData.insufficientRoleAndPermissionSeparation}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка сильности паролей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientDataAccessControl"
                            ref={inputs}
                            value={formData.insufficientDataAccessControl}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка уровня доступа:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfProtectionAgainstPrivilegeEscalation"
                            ref={inputs}
                            value={formData.lackOfProtectionAgainstPrivilegeEscalation}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Проведение тестирования на проникновение:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfProtectionAgainstPrivilegeEscalation"
                            ref={inputs}
                            value={formData.lackOfProtectionAgainstPrivilegeEscalation}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка многофакторной аутентификации:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfProtectionAgainstPrivilegeEscalation"
                            ref={inputs}
                            value={formData.lackOfProtectionAgainstPrivilegeEscalation}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.3.6">
                    <h2 className={"title-h2"}>6. Мониторинг и обнаружение инцидентов</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Оценка средств мониторинга:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="openPortsAndServices"
                            ref={inputs}
                            value={formData.openPortsAndServices}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Идентификация целей мониторинга:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="defaultPasswordsAndAccounts"
                            ref={inputs}
                            value={formData.defaultPasswordsAndAccounts}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Анализ данных и журналов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientDirectoryAndFileProtection"
                            ref={inputs}
                            value={formData.insufficientDirectoryAndFileProtection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка эффективности обнаружения:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="poorDatabaseConfiguration"
                            ref={inputs}
                            value={formData.poorDatabaseConfiguration}
                            onChange={handleChange}
                        />

                    </details>
                </section>


                <section id="section2.3.7">
                    <h2 className={"title-h2"}>7. Защита данных</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Идентификация конфиденциальных данных:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insecureDeserialization"
                            ref={inputs}
                            value={formData.insecureDeserialization}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка классификации данных:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="executionOfMaliciousCode"
                            ref={inputs}
                            value={formData.executionOfMaliciousCode}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка методов шифрования:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="dataModification"
                            ref={inputs}
                            value={formData.dataModification}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Контроль доступа к данным:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sessionAndAuthorizationAttacks"
                            ref={inputs}
                            value={formData.sessionAndAuthorizationAttacks}
                            onChange={handleChange}
                        />


                    </details>
                </section>

                <section id="section2.3.8">
                    <h2 className={"title-h2"}>8. Физическая безопасность</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Оценка доступа к физическим помещениям:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="useOfOutdatedComponents"
                            ref={inputs}
                            value={formData.useOfOutdatedComponents}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка механизмов идентификации:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfUpdateMonitoring"
                            ref={inputs}
                            value={formData.lackOfUpdateMonitoring}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Мониторинг доступа:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="useOfComponentsWithKnownVulnerabilities"
                            ref={inputs}
                            value={formData.useOfComponentsWithKnownVulnerabilities}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Оценка физической защиты оборудования:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="componentVersionInformationLeakage"
                            ref={inputs}
                            value={formData.componentVersionInformationLeakage}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Пожарная безопасность:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="cascadingImpact"
                            ref={inputs}
                            value={formData.cascadingImpact}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Электропитание и бэкапы:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="cascadingImpact"
                            ref={inputs}
                            value={formData.cascadingImpact}
                            onChange={handleChange}
                        />

                    </details>
                </section>

                <section id="section2.3.9">
                    <h2 className={"title-h2"}>9. Обучение и осведомленность пользователей</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Обучение пользователей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientEventLogging"
                            ref={inputs}
                            value={formData.insufficientEventLogging}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Социальная инженерия:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfAlarmsAndNotifications"
                            ref={inputs}
                            value={formData.lackOfAlarmsAndNotifications}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Политики безопасности:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="delayInIncidentDetection"
                            ref={inputs}
                            value={formData.delayInIncidentDetection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Уведомления и оповещения:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientLogRetention"
                            ref={inputs}
                            value={formData.insufficientLogRetention}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Сертификация и тестирование:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfSecurityAnalytics"
                            ref={inputs}
                            value={formData.lackOfSecurityAnalytics}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Регулярные обновления:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfSecurityAnalytics"
                            ref={inputs}
                            value={formData.lackOfSecurityAnalytics}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Формирование безопасной культуры:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfSecurityAnalytics"
                            ref={inputs}
                            value={formData.lackOfSecurityAnalytics}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Обратная связь и отчетность:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfSecurityAnalytics"
                            ref={inputs}
                            value={formData.lackOfSecurityAnalytics}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Соблюдение политик:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfSecurityAnalytics"
                            ref={inputs}
                            value={formData.lackOfSecurityAnalytics}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.3.10">
                    <h2 className={"title-h2"}>10. Планы восстановления после инцидента</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Оценка доступности планов восстановления:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientEventLogging"
                            ref={inputs}
                            value={formData.insufficientEventLogging}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Определение критических бизнес-процессов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfAlarmsAndNotifications"
                            ref={inputs}
                            value={formData.lackOfAlarmsAndNotifications}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Тестирование и обновление планов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="delayInIncidentDetection"
                            ref={inputs}
                            value={formData.delayInIncidentDetection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Роли и обязанности:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientLogRetention"
                            ref={inputs}
                            value={formData.insufficientLogRetention}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Коммуникация и уведомление:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfSecurityAnalytics"
                            ref={inputs}
                            value={formData.lackOfSecurityAnalytics}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Резервное копирование данных:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfSecurityAnalytics"
                            ref={inputs}
                            value={formData.lackOfSecurityAnalytics}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Инвентаризация оборудования и ресурсов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfSecurityAnalytics"
                            ref={inputs}
                            value={formData.lackOfSecurityAnalytics}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.3.11">
                    <h2 className={"title-h2"}>11. Аудит сети и сетевой безопасности</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Мониторинг сетевой активности:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientEventLogging"
                            ref={inputs}
                            value={formData.insufficientEventLogging}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Защита от вредоносных программ и атак:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfAlarmsAndNotifications"
                            ref={inputs}
                            value={formData.lackOfAlarmsAndNotifications}
                            onChange={handleChange}
                        />

                    </details>
                </section>

                <section id="section2.3.12">
                    <h2 className={"title-h2"}>12. Соблюдение стандартов и регуляций</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Законодательство:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientEventLogging"
                            ref={inputs}
                            value={formData.insufficientEventLogging}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Стандарты безопасности:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfAlarmsAndNotifications"
                            ref={inputs}
                            value={formData.lackOfAlarmsAndNotifications}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Отраслевые требования:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="delayInIncidentDetection"
                            ref={inputs}
                            value={formData.delayInIncidentDetection}
                            onChange={handleChange}
                        />

                    </details>
                </section>

            </details>
        </section>
    );
};

export default ISSAF;