import React, {useRef, useState} from 'react';
import instance from "../../../../../../store/api";
import XSS from "../../tests/xss/xss";
import CSRF from "../../tests/csrf/csrf";
import SqlInjection from "../../tests/sqlInjection/sqlInjection";
import Clickjacking from "../../tests/clickjacking/clickjacking";

const OWASP = () => {
    const [formData, setFormData] = useState({
        organizationName: '',
        personName: '',
        goalsAndTasks: '',
        dataCollection: '',
        dataFilteringAndAnalysis: '',
        dataStorage: '',
        url: '',
    });
    const inputs = useRef(null);

    const handleChange = (e) => {
        const {name, value} = e.target;
        setFormData({
            ...formData,
            [name]: value,
        });
    };

    const [data, setData] = useState("")

    const handleSubmit = async (e) => {
        e.preventDefault();
        try {
            const response = await instance.post('http://127.0.0.1:8000/api/pentesting/pentesting/', Object.assign({}, formData, data));
            // Обработка успешного ответа от сервера
            debugger
            console.log(response.data);
        } catch (error) {
            // Обработка ошибок при отправке запроса
            console.error(error);
        }
        console.log(formData)
        console.log(data)
    };

    return (
        <section id="section2.2">
            <h1 className={"title-h1"}>OWASP</h1>
            <details className={"details-main"} open>
                <summary className={"summary-main"}>
                    Скрыть
                </summary>
                <section id="section2.2.1">
                    <h2 className={"title-h2"}>1. Инъекции :</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>SQL Injection:</label>

                        <XSS/>
                        <CSRF/>
                        <SqlInjection/>
                        <Clickjacking/>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sqlInjection"
                            ref={inputs}
                            value={formData.sqlInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Cross-Site Scripting:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="crossSiteScripting"
                            ref={inputs}
                            value={formData.crossSiteScripting}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>XML Injection:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="xmlInjection"
                            ref={inputs}
                            value={formData.xmlInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Command Injection:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="commandInjection"
                            ref={inputs}
                            value={formData.commandInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>LDAP Injection:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="ldapInjection"
                            ref={inputs}
                            value={formData.ldapInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>NoSQL Injection:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="noSqlInjection"
                            ref={inputs}
                            value={formData.noSqlInjection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Server-Side Template Injection:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="serverSideTemplateInjection"
                            ref={inputs}
                            value={formData.serverSideTemplateInjection}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.2.2">
                    <h2 className={"title-h2"}>2. Нарушенная аутентификация :</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Недостаточная или отсутствующая аутентификация:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientAuthentication"
                            ref={inputs}
                            value={formData.insufficientAuthentication}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Ненадежное управление сессиями:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sessionManagement"
                            ref={inputs}
                            value={formData.sessionManagement}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Отсутствие времени ограничения сессии:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sessionTimeout"
                            ref={inputs}
                            value={formData.sessionTimeout}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Утечки информации о сессиях:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sessionInformationLeak"
                            ref={inputs}
                            value={formData.sessionInformationLeak}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Слабые пароли и недостаточная защита паролей:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="weakPasswords"
                            ref={inputs}
                            value={formData.weakPasswords}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.2.3">
                    <h2 className={"title-h2"}>3. Раскрытие критически важных данных</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Недостаточное шифрование данных:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientDataEncryption"
                            ref={inputs}
                            value={formData.insufficientDataEncryption}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Слабые алгоритмы шифрования:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="weakEncryptionAlgorithms"
                            ref={inputs}
                            value={formData.weakEncryptionAlgorithms}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Хранение паролей в ненадежной форме:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insecurePasswordStorage"
                            ref={inputs}
                            value={formData.insecurePasswordStorage}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Отсутствие аутентификации при доступе к чувствительным
                            данным:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfAuthenticationForSensitiveDataAccess"
                            ref={inputs}
                            value={formData.lackOfAuthenticationForSensitiveDataAccess}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Отсутствие контроля доступа и надежной аутентификации
                            API:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfApiAccessControlAndAuthentication"
                            ref={inputs}
                            value={formData.lackOfApiAccessControlAndAuthentication}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.2.4">
                    <h2 className={"title-h2"}>4. Внешние объекты XML (XXE)</h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Внешние сущности XML:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="xmlExternalEntities"
                            ref={inputs}
                            value={formData.xmlExternalEntities}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Некорректная фильтрация данных:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="incorrectDataFiltering"
                            ref={inputs}
                            value={formData.incorrectDataFiltering}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Удаленный доступ к файловой системе:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="remoteFileSystemAccess"
                            ref={inputs}
                            value={formData.remoteFileSystemAccess}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Отправка запросов к внешним ресурсам:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sendingRequestsToExternalResources"
                            ref={inputs}
                            value={formData.sendingRequestsToExternalResources}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Ускорение обработки данных:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="dataProcessingAcceleration"
                            ref={inputs}
                            value={formData.dataProcessingAcceleration}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.2.5">
                    <h2 className={"title-h2"}>5. Нарушенный контроль доступа </h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Недостаточное разделение ролей и прав:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientRoleAndPermissionSeparation"
                            ref={inputs}
                            value={formData.insufficientRoleAndPermissionSeparation}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Недостаточный контроль доступа к данным:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientDataAccessControl"
                            ref={inputs}
                            value={formData.insufficientDataAccessControl}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Отсутствие защиты от повышения привилегий:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfProtectionAgainstPrivilegeEscalation"
                            ref={inputs}
                            value={formData.lackOfProtectionAgainstPrivilegeEscalation}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.2.6">
                    <h2 className={"title-h2"}>6. Неправильная конфигурация безопасности </h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Открытые порты и службы:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="openPortsAndServices"
                            ref={inputs}
                            value={formData.openPortsAndServices}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Стандартные пароли и учетные записи:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="defaultPasswordsAndAccounts"
                            ref={inputs}
                            value={formData.defaultPasswordsAndAccounts}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Недостаточная защита каталогов и файлов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientDirectoryAndFileProtection"
                            ref={inputs}
                            value={formData.insufficientDirectoryAndFileProtection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Плохая настройка баз данных:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="poorDatabaseConfiguration"
                            ref={inputs}
                            value={formData.poorDatabaseConfiguration}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Уязвимости в веб-приложениях:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="webApplicationVulnerabilities"
                            ref={inputs}
                            value={formData.webApplicationVulnerabilities}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Утечка информации:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="dataLeakage"
                            ref={inputs}
                            value={formData.dataLeakage}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.2.7">
                    <h2 className={"title-h2"}>7. Межсайтовй скриптинг (XSS) </h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Отраженный (Reflected) XSS:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="reflectedXss"
                            ref={inputs}
                            value={formData.reflectedXss}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Постоянный (Stored) XSS:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="storedXss"
                            ref={inputs}
                            value={formData.storedXss}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>DOM-based XSS:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="domBasedXss"
                            ref={inputs}
                            value={formData.domBasedXss}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Blind XSS:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="blindXss"
                            ref={inputs}
                            value={formData.blindXss}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>XSS через внешние ресурсы (XSS via External
                            Resources):</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="xssViaExternalResources"
                            ref={inputs}
                            value={formData.xssViaExternalResources}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.2.8">
                    <h2 className={"title-h2"}>8. Небезопасная десериализация </h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Десериализация без проверки данных:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insecureDeserialization"
                            ref={inputs}
                            value={formData.insecureDeserialization}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Выполнение вредоносного кода:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="executionOfMaliciousCode"
                            ref={inputs}
                            value={formData.executionOfMaliciousCode}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Изменение данных:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="dataModification"
                            ref={inputs}
                            value={formData.dataModification}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Атаки на сессии и авторизацию:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="sessionAndAuthorizationAttacks"
                            ref={inputs}
                            value={formData.sessionAndAuthorizationAttacks}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Отказ в обслуживании (DoS):</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="denialOfService"
                            ref={inputs}
                            value={formData.denialOfService}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.2.9">
                    <h2 className={"title-h2"}>9. Использование компонентов с известными уязвимостями </h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Использование устаревших версий компонентов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="useOfOutdatedComponents"
                            ref={inputs}
                            value={formData.useOfOutdatedComponents}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Отсутствие мониторинга обновлений:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfUpdateMonitoring"
                            ref={inputs}
                            value={formData.lackOfUpdateMonitoring}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Использование компонентов с известными уязвимостями:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="useOfComponentsWithKnownVulnerabilities"
                            ref={inputs}
                            value={formData.useOfComponentsWithKnownVulnerabilities}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Утечка информации о версиях компонентов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="componentVersionInformationLeakage"
                            ref={inputs}
                            value={formData.componentVersionInformationLeakage}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Каскадное воздействие:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="cascadingImpact"
                            ref={inputs}
                            value={formData.cascadingImpact}
                            onChange={handleChange}
                        />
                    </details>
                </section>

                <section id="section2.2.10">
                    <h2 className={"title-h2"}>10. Недостаточно подробные журналы и слабый мониторинг </h2>
                    <details>
                        <summary>
                            Расскрыть
                        </summary>
                        <label className={"label-textarea"}>Недостаточное журналирование событий:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientEventLogging"
                            ref={inputs}
                            value={formData.insufficientEventLogging}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Отсутствие алармов и оповещений:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfAlarmsAndNotifications"
                            ref={inputs}
                            value={formData.lackOfAlarmsAndNotifications}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Задержка в обнаружении инцидентов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="delayInIncidentDetection"
                            ref={inputs}
                            value={formData.delayInIncidentDetection}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Недостаточное сохранение журналов:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="insufficientLogRetention"
                            ref={inputs}
                            value={formData.insufficientLogRetention}
                            onChange={handleChange}
                        />

                        <label className={"label-textarea"}>Отсутствие аналитики безопасности:</label>
                        <textarea
                            className={"Osint_textarea"}
                            type={"search"}
                            name="lackOfSecurityAnalytics"
                            ref={inputs}
                            value={formData.lackOfSecurityAnalytics}
                            onChange={handleChange}
                        />
                    </details>
                </section>
            </details>
        </section>
    );
};

export default OWASP;